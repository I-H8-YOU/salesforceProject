<template>
    <lightning-card title="üß† AI ÏºÄÏù¥Ïä§ ÏÉùÏÑ± ÎèÑÏö∞ÎØ∏">
        <div class="slds-p-around_medium">
            <template if:true={isLoading}>
                <lightning-spinner alternative-text="Î∂ÑÏÑù Ï§ë..."></lightning-spinner>
            </template>

            <template if:true={error}>
                <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_error slds-m-bottom_small" role="alert">
                    <span class="slds-assistive-text">Error</span>
                    <span>{error}</span>
                </div>
            </template>

            <template if:true={showInput}>
                <lightning-input label="Í≥†Í∞ù Ïù¥Î¶Ñ" value={customerName} onchange={handleName}></lightning-input>
                <lightning-textarea label="Î¨∏Ï†ú ÏÑ§Î™Ö" value={issueDescription} onchange={handleDescription} oninput={adjustHeight}></lightning-textarea>

                <!-- Î≤ÑÌäº Ï†ïÎ†¨ -->
                <div class="slds-grid slds-grid_align-spread slds-m-top_medium">
                    <lightning-button label="üìã Í≥†Í∞ù ÏöîÏïΩ Ï†ïÎ≥¥" variant="neutral" onclick={handleShowCustomerInfo}></lightning-button>
                    <lightning-button label="AI Î∂ÑÏÑùÌïòÍ∏∞" variant="brand" onclick={handleAnalyze}></lightning-button>
                </div>
            </template>

            <template if:true={showResult}>
                <p class="slds-text-heading_small">üîß ÏºÄÏù¥Ïä§ Ï†ïÎ≥¥ ÎØ∏Î¶¨Î≥¥Í∏∞</p>
                <lightning-record-edit-form object-api-name="Case" onsubmit={handleSubmit} onsuccess={handleSuccess}>
                    <lightning-messages></lightning-messages>
                    <lightning-input-field field-name="ContactId" value={caseData.contactId}></lightning-input-field>
                    <lightning-input-field field-name="AccountId" value={caseData.accountId}></lightning-input-field>
                    <lightning-input-field field-name="AssetId" value={caseData.assetId}></lightning-input-field>
                    <lightning-input-field field-name="Subject" value={caseData.subject}></lightning-input-field>
                    <lightning-textarea label="Description" readonly value={animatedDescription}></lightning-textarea>

                    <div class="slds-grid slds-grid_align-spread slds-m-top_medium">
                        <lightning-button label="‚¨ÖÔ∏è Îí§Î°ú" onclick={handleBack}></lightning-button>
                        <lightning-button type="submit" label={submitButtonLabel} variant="success" disabled={isSaving}></lightning-button>
                    </div>
                </lightning-record-edit-form>
            </template>
        </div>
    </lightning-card>
</template>
